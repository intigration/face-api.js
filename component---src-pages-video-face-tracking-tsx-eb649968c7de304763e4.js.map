{"version":3,"sources":["webpack:///./src/pages/video_face_tracking.tsx","webpack:///./src/components/FaceDetection.tsx","webpack:///./src/components/TrackFaces.tsx","webpack:///./src/components/FaceAndLandmarkDetection.tsx","webpack:///./src/components/VideoWithOverlay.tsx","webpack:///./src/components/TrackFacesWithLandmarks.tsx"],"names":["render","window","document","input","video","overlay","setState","EXAMPLE_VIDEO","state","FACE_DETECTORS","TinyFaceDetectorOptions","inputSize","detectionOptions","withBoxes","withLandmarks","React","FaceDetection","props","initialFaceDetector","initialTinyFaceDetectorOptions","detectorName","renderFaceDetectorSelection","renderFaceDetectorControls","getFaceDetectionModelUri","MODELS_URI","renderCheckboxes","children","TrackFaces","isActive","run","setTimeout","runTask","results","displayResults","displayOptions","componentDidMount","componentWillUnmount","FaceAndLandmarkDetection","VideoWithOverlay","isLoaded","onChange","bind","onVideoRef","onCanvasRef","onPlay","getBoundingClientRect","width","height","onLoaded","MediaElement","el","componentWillReceiveProps","nextProps","srcObject","shouldComponentUpdate","componentDidUpdate","position","maxWidth","maxVideoWidth","src","top","left","TrackFacesWithLandmarks","task","faceapi","element","withFaceLandmarks"],"mappings":"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","file":"component---src-pages-video-face-tracking-tsx-eb649968c7de304763e4.js","sourcesContent":["import { TinyFaceDetectorOptions } from 'face-api.js';\nimport * as React from 'react';\n\nimport { MediaElement } from '../../face-api.js-react/MediaElement';\nimport { FaceAndLandmarkDetection } from '../components/FaceAndLandmarkDetection';\nimport { TrackFacesWithLandmarks } from '../components/TrackFacesWithLandmarks';\nimport { VideoWithOverlay } from '../components/VideoWithOverlay';\nimport { EXAMPLE_VIDEO, FACE_DETECTORS } from '../const';\nimport { Root } from '../Root';\n\ntype PageState = {\n  input?: MediaElement\n  overlay?: HTMLCanvasElement\n}\n\nexport default class extends React.Component<{}, PageState> {\n\n  public render() {\n    if (!(typeof window !== 'undefined' && window.document) ){\n      return null\n    }\n\n    return(\n      <Root>\n        <VideoWithOverlay\n          onLoaded={({ video: input, overlay }) => this.setState({ input, overlay })}\n          maxVideoWidth={800}\n          src={EXAMPLE_VIDEO}\n        />\n        <FaceAndLandmarkDetection\n          {...this.state}\n          initialFaceDetector={FACE_DETECTORS[0]}\n          initialTinyFaceDetectorOptions={new TinyFaceDetectorOptions({ inputSize: 416 })}\n        >\n        {(detectionOptions, withBoxes, withLandmarks) =>\n          <TrackFacesWithLandmarks\n            detectionOptions={detectionOptions}\n            withBoxes={withBoxes}\n            withLandmarks={withLandmarks}\n            {...this.state}\n          />\n        }\n        </FaceAndLandmarkDetection>\n      </Root>\n    )\n  }\n}","import * as Mui from '@material-ui/core';\r\nimport { FaceDetectionOptions, TinyFaceDetectorOptions } from 'face-api.js';\r\nimport { LoadModels } from 'face-api.js-react';\r\nimport * as React from 'react';\r\n\r\nimport { ReactElement } from '../../face-api.js-react';\r\nimport { ModalLoader } from '../components/ModalLoader';\r\nimport { getFaceDetectionModelUri, MODELS_URI } from '../const';\r\nimport { SelectFaceDetector } from '../facc/SelectFaceDetector';\r\nimport { CenterContent } from '../styled/CenterContent';\r\n\r\n\r\ntype Props = {\r\n  initialFaceDetector: string\r\n  initialTinyFaceDetectorOptions?: TinyFaceDetectorOptions\r\n  children?: (detectionOptions: FaceDetectionOptions, withBoxes: boolean) => ReactElement\r\n  renderCheckboxes?: () => ReactElement\r\n}\r\n\r\ntype FaceDetectionState = {\r\n  withBoxes: boolean\r\n}\r\n\r\nexport class FaceDetection extends React.Component<Props, FaceDetectionState> {\r\n\r\n  state: FaceDetectionState = {\r\n    withBoxes: true\r\n  }\r\n\r\n  public render() {\r\n    return (\r\n      <SelectFaceDetector\r\n        initialFaceDetector={this.props.initialFaceDetector}\r\n        initialTinyFaceDetectorOptions={this.props.initialTinyFaceDetectorOptions}\r\n      >\r\n      {(detectorName, detectionOptions, renderFaceDetectorSelection, renderFaceDetectorControls) =>\r\n        <LoadModels\r\n          {...getFaceDetectionModelUri(detectorName, MODELS_URI)}\r\n          faceLandmarkModelUrl={MODELS_URI}\r\n          renderBusyComponent={() => <ModalLoader title={`Loading ${detectorName} Model`} />}\r\n        >\r\n        {() =>\r\n          <div>\r\n            <CenterContent>\r\n              { renderFaceDetectorSelection() }\r\n              <CenterContent flexDirection=\"column\" alignItems=\"baseline\">\r\n                {\r\n                  this.props.renderCheckboxes ? this.props.renderCheckboxes() : null\r\n                }\r\n                <Mui.FormControlLabel\r\n                  control={\r\n                    <Mui.Checkbox\r\n                      checked={!this.state.withBoxes}\r\n                      onChange={() => this.setState({ withBoxes: !this.state.withBoxes })}\r\n                      color=\"primary\"\r\n                    />\r\n                  }\r\n                  label=\"Hide Bounding Boxes\"\r\n                />\r\n                </CenterContent>\r\n            </CenterContent>\r\n            { renderFaceDetectorControls() }\r\n            { this.props.children ? this.props.children(detectionOptions, this.state.withBoxes) : null }\r\n          </div>\r\n        }\r\n        </LoadModels>\r\n      }\r\n      </SelectFaceDetector>\r\n    )\r\n  }\r\n}\r\n","import * as faceapi from 'face-api.js';\r\nimport * as React from 'react';\r\n\r\nimport { displayResults } from '../../face-api.js-react';\r\nimport { DisplayResultsOptions } from '../../face-api.js-react/displayResults';\r\nimport { MediaElement } from '../../face-api.js-react/MediaElement';\r\n\r\nexport type TrackFacesProps = {\r\n  input?: MediaElement\r\n  overlay?: HTMLCanvasElement\r\n  displayOptions?: DisplayResultsOptions\r\n  runTask: () => Promise<\r\n    faceapi.FaceDetection[]\r\n    | faceapi.WithFaceLandmarks<faceapi.WithFaceDetection<{}>>[]\r\n    | faceapi.WithFaceExpressions<faceapi.WithFaceDetection<{}>>[]\r\n  >\r\n}\r\n\r\nexport class TrackFaces extends React.Component<TrackFacesProps> {\r\n\r\n  isActive: boolean = false\r\n\r\n  run = async () => {\r\n    if (!this.isActive) {\r\n      return\r\n    }\r\n\r\n    if (!this.props.input) {\r\n      return setTimeout(this.run, 0)\r\n    }\r\n\r\n    const results = await this.props.runTask()\r\n    displayResults(this.props.input, this.props.overlay, results, this.props.displayOptions)\r\n\r\n    setTimeout(this.run, 0)\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.isActive = true\r\n    this.run()\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    this.isActive = false\r\n  }\r\n\r\n  public render(): any {\r\n    return null\r\n  }\r\n}","import * as Mui from '@material-ui/core';\r\nimport { FaceDetectionOptions, TinyFaceDetectorOptions } from 'face-api.js';\r\nimport { MediaElement } from 'face-api.js-react';\r\nimport * as React from 'react';\r\n\r\nimport { ReactElement } from '../../face-api.js-react';\r\nimport { FaceDetection } from './FaceDetection';\r\n\r\nexport type FaceAndLandmarkDetectionProps = {\r\n  input?: MediaElement\r\n  overlay?: HTMLCanvasElement\r\n}\r\n\r\ntype Props = FaceAndLandmarkDetectionProps & {\r\n  initialFaceDetector: string\r\n  initialTinyFaceDetectorOptions?: TinyFaceDetectorOptions\r\n  children?: (detectionOptions: FaceDetectionOptions, withBoxes: boolean, withLandmarks: boolean) => ReactElement\r\n}\r\n\r\ntype FaceAndLandmarkDetectionState = {\r\n  withLandmarks: boolean\r\n}\r\n\r\nexport class FaceAndLandmarkDetection extends React.Component<Props, FaceAndLandmarkDetectionState> {\r\n\r\n  state: FaceAndLandmarkDetectionState = {\r\n    withLandmarks: false\r\n  }\r\n\r\n  public render() {\r\n    return (\r\n      <FaceDetection\r\n        {...this.props}\r\n        renderCheckboxes={\r\n          () =>\r\n            <Mui.FormControlLabel\r\n              control={\r\n                <Mui.Checkbox\r\n                  checked={this.state.withLandmarks}\r\n                  onChange={() => this.setState({ withLandmarks: !this.state.withLandmarks })}\r\n                  color=\"primary\"\r\n                />\r\n              }\r\n              label=\"Detect Face Landmarks\"\r\n            />\r\n        }\r\n      >\r\n        {\r\n          (detectionOptions, withBoxes) =>\r\n            this.props.children(detectionOptions, withBoxes, this.state.withLandmarks)\r\n        }\r\n      </FaceDetection>\r\n    )\r\n  }\r\n}\r\n","import { MediaElement } from 'face-api.js-react';\nimport * as React from 'react';\n\nexport type VideoWithOverlayProps = {\n  onLoaded?: (refs: { video: MediaElement, overlay: HTMLCanvasElement }) => any\n  onVideoRef?: () => any\n  maxVideoWidth?: number\n  src?: string\n  srcObject?: MediaStream | MediaSource | Blob | null\n}\n\nexport class VideoWithOverlay extends React.Component<VideoWithOverlayProps> {\n  video: HTMLVideoElement | undefined\n  overlay: HTMLCanvasElement | undefined\n  isLoaded: boolean = false\n\n  constructor(props: VideoWithOverlayProps) {\n    super(props)\n\n    this.onChange = this.onChange.bind(this)\n    this.onVideoRef = this.onVideoRef.bind(this)\n    this.onCanvasRef = this.onCanvasRef.bind(this)\n    this.onPlay = this.onPlay.bind(this)\n  }\n\n  onChange() {\n    const { video, overlay, isLoaded } = this\n\n    if (video && overlay && isLoaded) {\n      const { width, height } = this.video.getBoundingClientRect()\n      this.overlay.width = width,\n      this.overlay.height = height\n      this.props.onLoaded({ video: new MediaElement(video), overlay })\n    }\n  }\n\n  onVideoRef(el: HTMLVideoElement) {\n    this.video = el\n    this.props.onVideoRef && this.props.onVideoRef()\n    this.onChange()\n  }\n\n  onCanvasRef(el: HTMLCanvasElement) {\n    this.overlay = el\n    this.onChange()\n  }\n\n  onPlay() {\n    this.isLoaded = true\n    this.onChange()\n  }\n\n  componentWillReceiveProps(nextProps: VideoWithOverlayProps) {\n    const { srcObject } = nextProps\n    if (srcObject && this.props.srcObject !== srcObject) {\n      this.video.srcObject = srcObject\n    }\n  }\n\n  shouldComponentUpdate() {\n    return false\n  }\n\n  componentDidUpdate() {\n    this.onChange()\n  }\n\n  componentDidMount() {\n    this.onChange()\n  }\n\n  public render() {\n    return(\n      <div style={{ position: 'relative' }}>\n        <video\n          muted\n          autoPlay\n          style={{ width: '100%', maxWidth: this.props.maxVideoWidth }}\n          ref={this.onVideoRef}\n          onPlay={this.onPlay}\n          src={this.props.src}\n        />\n        <canvas\n          style={{ position: 'absolute', top: 0, left: 0 }}\n          ref={this.onCanvasRef}\n        />\n      </div>\n    )\n  }\n}","import * as faceapi from 'face-api.js';\r\nimport * as React from 'react';\r\n\r\nimport { MediaElement } from '../../face-api.js-react';\r\nimport { FaceDetectionOptions } from 'face-api.js';\r\nimport { TrackFaces } from './TrackFaces';\r\n\r\nexport type TrackFacesWithLandmarksProps = {\r\n  input?: MediaElement\r\n  detectionOptions: FaceDetectionOptions\r\n  withBoxes: boolean\r\n  withLandmarks: boolean\r\n}\r\n\r\nexport class TrackFacesWithLandmarks extends React.Component<TrackFacesWithLandmarksProps> {\r\n  public render(): any {\r\n    const runTask = async () => {\r\n      let task = faceapi.detectAllFaces(this.props.input.element, this.props.detectionOptions)\r\n      if (this.props.withLandmarks) {\r\n        return task.withFaceLandmarks()\r\n      }\r\n      return task\r\n    }\r\n    const { withBoxes } = this.props\r\n\r\n    return (\r\n      <TrackFaces\r\n        {...this.props}\r\n        displayOptions={{ withBoxes }}\r\n        runTask={runTask}\r\n      />\r\n    )\r\n  }\r\n}"],"sourceRoot":""}
{"version":3,"sources":["webpack:///./src/pages/webcam_face_expression_recognition.tsx","webpack:///./src/components/FaceDetection.tsx","webpack:///./src/components/TrackFaces.tsx","webpack:///./src/components/VideoWithOverlay.tsx","webpack:///./src/components/TrackFacesWithExpressions.tsx","webpack:///./src/components/WebcamVideoWithOverlay.tsx","webpack:///./node_modules/gatsby/node_modules/core-js/modules/es6.regexp.to-string.js","webpack:///./node_modules/gatsby/node_modules/core-js/modules/es6.regexp.flags.js"],"names":["render","window","document","input","video","overlay","setState","MODELS_URI","state","FACE_DETECTORS","TinyFaceDetectorOptions","inputSize","detectionOptions","withBoxes","React","FaceDetection","props","initialFaceDetector","initialTinyFaceDetectorOptions","detectorName","renderFaceDetectorSelection","renderFaceDetectorControls","getFaceDetectionModelUri","renderCheckboxes","children","TrackFaces","isActive","run","setTimeout","runTask","results","displayResults","displayOptions","componentDidMount","componentWillUnmount","VideoWithOverlay","isLoaded","onChange","bind","onVideoRef","onCanvasRef","onPlay","getBoundingClientRect","width","height","onLoaded","MediaElement","el","componentWillReceiveProps","nextProps","srcObject","shouldComponentUpdate","componentDidUpdate","position","maxWidth","maxVideoWidth","src","top","left","TrackFacesWithExpressions","withScore","faceapi","element","withFaceExpressions","WebcamVideoWithOverlay","navigator","mediaDevices","getUserMedia","error","toString","background","color"],"mappings":"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","file":"component---src-pages-webcam-face-expression-recognition-tsx-7e7598daa571aa609afd.js","sourcesContent":["import { TinyFaceDetectorOptions } from 'face-api.js';\nimport { LoadModels } from 'face-api.js-react';\nimport * as React from 'react';\n\nimport { MediaElement } from '../../face-api.js-react/MediaElement';\nimport { FaceDetection } from '../components/FaceDetection';\nimport { TrackFacesWithExpressions } from '../components/TrackFacesWithExpressions';\nimport { WebcamVideoWithOverlay } from '../components/WebcamVideoWithOverlay';\nimport { FACE_DETECTORS, MODELS_URI } from '../const';\nimport { Root } from '../Root';\n\ntype PageState = {\n  input?: MediaElement\n  overlay?: HTMLCanvasElement\n  withLandmarks: boolean\n}\n\nexport default class extends React.Component<{}, PageState> {\n\n  public render() {\n    if (!(typeof window !== 'undefined' && window.document) ){\n      return null\n    }\n\n    return(\n      <Root>\n        <WebcamVideoWithOverlay\n          onLoaded={({ video: input, overlay }) => this.setState({ input, overlay })}\n          maxVideoWidth={800}\n        />\n        <LoadModels faceExpessionModelUrl={MODELS_URI}>\n        {\n          () =>\n            <FaceDetection\n              {...this.state}\n              initialFaceDetector={FACE_DETECTORS[0]}\n              initialTinyFaceDetectorOptions={new TinyFaceDetectorOptions({ inputSize: 224 })}\n            >\n            {(detectionOptions, withBoxes) =>\n              <TrackFacesWithExpressions\n                detectionOptions={detectionOptions}\n                withBoxes={withBoxes}\n                {...this.state}\n              />\n            }\n            </FaceDetection>\n        }\n        </LoadModels>\n      </Root>\n    )\n  }\n}","import * as Mui from '@material-ui/core';\r\nimport { FaceDetectionOptions, TinyFaceDetectorOptions } from 'face-api.js';\r\nimport { LoadModels } from 'face-api.js-react';\r\nimport * as React from 'react';\r\n\r\nimport { ReactElement } from '../../face-api.js-react';\r\nimport { ModalLoader } from '../components/ModalLoader';\r\nimport { getFaceDetectionModelUri, MODELS_URI } from '../const';\r\nimport { SelectFaceDetector } from '../facc/SelectFaceDetector';\r\nimport { CenterContent } from '../styled/CenterContent';\r\n\r\n\r\ntype Props = {\r\n  initialFaceDetector: string\r\n  initialTinyFaceDetectorOptions?: TinyFaceDetectorOptions\r\n  children?: (detectionOptions: FaceDetectionOptions, withBoxes: boolean) => ReactElement\r\n  renderCheckboxes?: () => ReactElement\r\n}\r\n\r\ntype FaceDetectionState = {\r\n  withBoxes: boolean\r\n}\r\n\r\nexport class FaceDetection extends React.Component<Props, FaceDetectionState> {\r\n\r\n  state: FaceDetectionState = {\r\n    withBoxes: true\r\n  }\r\n\r\n  public render() {\r\n    return (\r\n      <SelectFaceDetector\r\n        initialFaceDetector={this.props.initialFaceDetector}\r\n        initialTinyFaceDetectorOptions={this.props.initialTinyFaceDetectorOptions}\r\n      >\r\n      {(detectorName, detectionOptions, renderFaceDetectorSelection, renderFaceDetectorControls) =>\r\n        <LoadModels\r\n          {...getFaceDetectionModelUri(detectorName, MODELS_URI)}\r\n          faceLandmarkModelUrl={MODELS_URI}\r\n          renderBusyComponent={() => <ModalLoader title={`Loading ${detectorName} Model`} />}\r\n        >\r\n        {() =>\r\n          <div>\r\n            <CenterContent>\r\n              { renderFaceDetectorSelection() }\r\n              <CenterContent flexDirection=\"column\" alignItems=\"baseline\">\r\n                {\r\n                  this.props.renderCheckboxes ? this.props.renderCheckboxes() : null\r\n                }\r\n                <Mui.FormControlLabel\r\n                  control={\r\n                    <Mui.Checkbox\r\n                      checked={!this.state.withBoxes}\r\n                      onChange={() => this.setState({ withBoxes: !this.state.withBoxes })}\r\n                      color=\"primary\"\r\n                    />\r\n                  }\r\n                  label=\"Hide Bounding Boxes\"\r\n                />\r\n                </CenterContent>\r\n            </CenterContent>\r\n            { renderFaceDetectorControls() }\r\n            { this.props.children ? this.props.children(detectionOptions, this.state.withBoxes) : null }\r\n          </div>\r\n        }\r\n        </LoadModels>\r\n      }\r\n      </SelectFaceDetector>\r\n    )\r\n  }\r\n}\r\n","import * as faceapi from 'face-api.js';\r\nimport * as React from 'react';\r\n\r\nimport { displayResults } from '../../face-api.js-react';\r\nimport { DisplayResultsOptions } from '../../face-api.js-react/displayResults';\r\nimport { MediaElement } from '../../face-api.js-react/MediaElement';\r\n\r\nexport type TrackFacesProps = {\r\n  input?: MediaElement\r\n  overlay?: HTMLCanvasElement\r\n  displayOptions?: DisplayResultsOptions\r\n  runTask: () => Promise<\r\n    faceapi.FaceDetection[]\r\n    | faceapi.WithFaceLandmarks<faceapi.WithFaceDetection<{}>>[]\r\n    | faceapi.WithFaceExpressions<faceapi.WithFaceDetection<{}>>[]\r\n  >\r\n}\r\n\r\nexport class TrackFaces extends React.Component<TrackFacesProps> {\r\n\r\n  isActive: boolean = false\r\n\r\n  run = async () => {\r\n    if (!this.isActive) {\r\n      return\r\n    }\r\n\r\n    if (!this.props.input) {\r\n      return setTimeout(this.run, 0)\r\n    }\r\n\r\n    const results = await this.props.runTask()\r\n    displayResults(this.props.input, this.props.overlay, results, this.props.displayOptions)\r\n\r\n    setTimeout(this.run, 0)\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.isActive = true\r\n    this.run()\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    this.isActive = false\r\n  }\r\n\r\n  public render(): any {\r\n    return null\r\n  }\r\n}","import { MediaElement } from 'face-api.js-react';\nimport * as React from 'react';\n\nexport type VideoWithOverlayProps = {\n  onLoaded?: (refs: { video: MediaElement, overlay: HTMLCanvasElement }) => any\n  onVideoRef?: () => any\n  maxVideoWidth?: number\n  src?: string\n  srcObject?: MediaStream | MediaSource | Blob | null\n}\n\nexport class VideoWithOverlay extends React.Component<VideoWithOverlayProps> {\n  video: HTMLVideoElement | undefined\n  overlay: HTMLCanvasElement | undefined\n  isLoaded: boolean = false\n\n  constructor(props: VideoWithOverlayProps) {\n    super(props)\n\n    this.onChange = this.onChange.bind(this)\n    this.onVideoRef = this.onVideoRef.bind(this)\n    this.onCanvasRef = this.onCanvasRef.bind(this)\n    this.onPlay = this.onPlay.bind(this)\n  }\n\n  onChange() {\n    const { video, overlay, isLoaded } = this\n\n    if (video && overlay && isLoaded) {\n      const { width, height } = this.video.getBoundingClientRect()\n      this.overlay.width = width,\n      this.overlay.height = height\n      this.props.onLoaded({ video: new MediaElement(video), overlay })\n    }\n  }\n\n  onVideoRef(el: HTMLVideoElement) {\n    this.video = el\n    this.props.onVideoRef && this.props.onVideoRef()\n    this.onChange()\n  }\n\n  onCanvasRef(el: HTMLCanvasElement) {\n    this.overlay = el\n    this.onChange()\n  }\n\n  onPlay() {\n    this.isLoaded = true\n    this.onChange()\n  }\n\n  componentWillReceiveProps(nextProps: VideoWithOverlayProps) {\n    const { srcObject } = nextProps\n    if (srcObject && this.props.srcObject !== srcObject) {\n      this.video.srcObject = srcObject\n    }\n  }\n\n  shouldComponentUpdate() {\n    return false\n  }\n\n  componentDidUpdate() {\n    this.onChange()\n  }\n\n  componentDidMount() {\n    this.onChange()\n  }\n\n  public render() {\n    return(\n      <div style={{ position: 'relative' }}>\n        <video\n          muted\n          autoPlay\n          style={{ width: '100%', maxWidth: this.props.maxVideoWidth }}\n          ref={this.onVideoRef}\n          onPlay={this.onPlay}\n          src={this.props.src}\n        />\n        <canvas\n          style={{ position: 'absolute', top: 0, left: 0 }}\n          ref={this.onCanvasRef}\n        />\n      </div>\n    )\n  }\n}","import * as faceapi from 'face-api.js';\r\nimport * as React from 'react';\r\n\r\nimport { MediaElement } from '../../face-api.js-react';\r\nimport { FaceDetectionOptions } from 'face-api.js';\r\nimport { TrackFaces } from './TrackFaces';\r\n\r\nexport type TrackFacesWithExpressionsProps = {\r\n  input?: MediaElement\r\n  detectionOptions: FaceDetectionOptions\r\n  withBoxes: boolean\r\n}\r\n\r\nexport class TrackFacesWithExpressions extends React.Component<TrackFacesWithExpressionsProps> {\r\n  public render(): any {\r\n    const { withBoxes } = this.props\r\n    return (\r\n      <TrackFaces\r\n        {...this.props}\r\n        displayOptions={{ withBoxes, withScore: false }}\r\n        runTask={async () => faceapi.detectAllFaces(this.props.input.element, this.props.detectionOptions).withFaceExpressions()}\r\n      />\r\n    )\r\n  }\r\n}","import { MediaElement } from 'face-api.js-react';\nimport * as React from 'react';\n\nimport { VideoWithOverlay } from './VideoWithOverlay';\n\nexport type WebcamVideoWithOverlayProps = {\n  onLoaded: (refs: { video: MediaElement, overlay: HTMLCanvasElement }) => any\n  maxVideoWidth?: number\n}\n\ntype WebcamVideoWithOverlayState = {\n  srcObject?: MediaStream | MediaSource | Blob | null\n  error?: string\n}\n\nexport class WebcamVideoWithOverlay extends React.Component<WebcamVideoWithOverlayProps, WebcamVideoWithOverlayState> {\n  state: WebcamVideoWithOverlayState = {\n  }\n\n  onVideoRef = async () => {\n    try {\n      const srcObject = await navigator.mediaDevices.getUserMedia({ video: {} })\n      this.setState({ srcObject })\n    } catch (err) {\n      this.setState({ error: err.toString() })\n    }\n  }\n\n  public render() {\n    if (this.state.error) {\n      return (\n        <div style={{ background: 'red', color: 'white' }}>\n          <h3> Error occured while requesting webcam access: </h3>\n          <p> { this.state.error } </p>\n        </div>\n      )\n    }\n\n    return(\n      <VideoWithOverlay\n        srcObject={this.state.srcObject}\n        onLoaded={this.props.onLoaded}\n        maxVideoWidth={this.props.maxVideoWidth}\n        onVideoRef={this.onVideoRef}\n      />\n    )\n  }\n}","'use strict';\nrequire('./es6.regexp.flags');\nvar anObject = require('./_an-object');\nvar $flags = require('./_flags');\nvar DESCRIPTORS = require('./_descriptors');\nvar TO_STRING = 'toString';\nvar $toString = /./[TO_STRING];\n\nvar define = function (fn) {\n  require('./_redefine')(RegExp.prototype, TO_STRING, fn, true);\n};\n\n// 21.2.5.14 RegExp.prototype.toString()\nif (require('./_fails')(function () { return $toString.call({ source: 'a', flags: 'b' }) != '/a/b'; })) {\n  define(function toString() {\n    var R = anObject(this);\n    return '/'.concat(R.source, '/',\n      'flags' in R ? R.flags : !DESCRIPTORS && R instanceof RegExp ? $flags.call(R) : undefined);\n  });\n// FF44- RegExp#toString has a wrong name\n} else if ($toString.name != TO_STRING) {\n  define(function toString() {\n    return $toString.call(this);\n  });\n}\n","// 21.2.5.3 get RegExp.prototype.flags()\nif (require('./_descriptors') && /./g.flags != 'g') require('./_object-dp').f(RegExp.prototype, 'flags', {\n  configurable: true,\n  get: require('./_flags')\n});\n"],"sourceRoot":""}